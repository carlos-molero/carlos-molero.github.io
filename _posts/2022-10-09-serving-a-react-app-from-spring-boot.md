---
layout: post
title: Serving A React App From Spring Boot
author: Carlos Molero Mata
description: Step by step explanation of how to build and serve your React App from a Spring Boot backend.
header-style: text
tags: [java, springboot, javascript, react]
---

Serving the front end from your backend is often referred as a **monolithic approach**. It makes sense sometimes, specially when we are talking about **an internal or small project but is not recommended for enterprise applications** since you are binding both apps into one 'bundle' and losing the freedom of hosting them with different architectures - e.g. a cluster of servers behind a load balancer for the backend, and caching/CDN for frontend and static assets. This is potentially more cost-efficient and/or has better performance at scale.

## Modifying our `pom.xml`

The `pom.xml` file allows us configure and tune our build process, we can add multiple plugins to it. Please, notice that the order of the plugins **does matter**.

### Generating the client build folder

To include the client build script in our Maven build process we are going to use the [`frontend-maven-plugin`](https://github.com/eirslett/frontend-maven-plugin).

Plugins are added inside the `<build>` and `<plugins>` tags. Open your `pom.xml` file and add the following inside those tags:

```xml
<plugin>
    <groupId>com.github.eirslett</groupId>
    <artifactId>frontend-maven-plugin</artifactId>
    <version>1.6</version>
    <configuration>
        <workingDirectory>client</workingDirectory>
        <installDirectory>target</installDirectory>
    </configuration>
    <executions>
        <execution>
            <id>install node and npm</id>
            <goals>
                <goal>install-node-and-yarn</goal>
            </goals>
            <configuration>
                <nodeVersion>v16.16.0</nodeVersion>
                <yarnVersion>v1.22.19</yarnVersion>
            </configuration>
        </execution>
        <execution>
            <id>npm install</id>
            <goals>
                <goal>yarn</goal>
            </goals>
            <configuration>
                <arguments>install</arguments>
            </configuration>
        </execution>
        <execution>
            <id>yarn build</id>
            <goals>
                <goal>yarn</goal>
            </goals>
            <configuration>
                <arguments>build</arguments>
            </configuration>
        </execution>
    </executions>
</plugin>
```

Nothing fancy here, we are telling Maven that, when it executes the `package` lifecycle method, we want to run `yarn build` inside our `/client` folder after installing `yarn` and `node`.

### Copying the build folder to our server

The next step should be copying the files generated by the client build script to our server. For this task, we are going to use the [`maven-antrun-plugin`](https://maven.apache.org/plugins/maven-antrun-plugin/) which allows us to execute `ant` tasks like `<copy>`. So, let's add this plugin to our build pipeline:

```xml
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <executions>
        <execution>
            <phase>generate-resources</phase>
            <configuration>
                <target>
                    <copy todir="${project.build.directory}/classes/public">
                        <fileset dir="${project.basedir}/client/build" />
                    </copy>
                </target>
            </configuration>
            <goals>
                <goal>run</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

This will tell Maven that we want to copy the files placed at `/client/build` to `/classes/public`. Taking into account that the `project.build.directory` variable resolves to `/target` the full path would be `/target/classes/public`. This is where the build files of our React App will be at the end of the build process.

## Spring Boot config

As you probably know, React is a framework which is meant to ease the task of developing Single Page Applications ([SPA](https://www.techtarget.com/whatis/definition/single-page-application-SPA)). If we are using [React Router](https://reactrouter.com/en/main) to handle the navigation we will notice that accessing a different path than `/` directly from our browser will return a `404 Not Found` error.

This is because routing in React, _explained in a very simple way_, is handled entirely from the root of your application. You cannot just enter a path and expect to receive the component which should be rendered in it because **that path doesn't exists**, navigation must be handled by React Router and that means clicking a link or using the `navigate()` function. In hosting providers like [Netlify](https://www.netlify.com/) or [Cloudflare pages](https://pages.cloudflare.com/) this is fixed by adding a redirect rule that redirects every path to your `index.html` file.

To solve this in Spring Boot, we need to use a `@Configuration` class which implements `ViewResolver`. The `ViewResolver` interface enables you to render models in the browser without tying the implementation to a specific view technology. This interface has a method called `resolveErrorView()` that will be triggered on every path request. You're guessing right, we are going to take advantage of it to perform a redirect when the `HTTPStatus` is `NOT_FOUND`.

```java
@Configuration
public class WebConfig implements ErrorViewResolver {
    @Override
    public ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status, Map<String, Object> model) {
        if (status == HttpStatus.NOT_FOUND) {
            return new ModelAndView("forward:/");
        }
        return null;
    }

}
```

The code is self-explanatory, we `@Override` the abovementioned method and check if the status is not found, if it is we perform a redirect to the root path.

Finally, if you're using `spring-boot-starter-security` in your project remember to handle `CORS` requests to the client-side routes and to allow `GET` traffic to them.

---

Now you know how to serve a React App from a Spring Boot backend, hope you learnt something useful today and see you in the next post!
